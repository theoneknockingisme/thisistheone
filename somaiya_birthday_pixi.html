<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Happy Birthday, Somaiya!</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
  }
  canvas {
    display: block;
  }
</style>
<!-- PIXIJS + GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
</head>
<body>
<script>
const app = new PIXI.Application({
    resizeTo: window,
    backgroundColor: 0x000000
});
document.body.appendChild(app.view);

// ----- SCENE SETUP -----

// Sky gradient
const sky = new PIXI.Graphics();
const skyTexture = app.renderer.generateTexture((() => {
    const g = new PIXI.Graphics();
    const grad = g.beginTextureFill({texture: PIXI.Texture.WHITE});
    const canvas = document.createElement('canvas');
    canvas.width = 1;
    canvas.height = 256;
    const ctx = canvas.getContext('2d');
    const gradient = ctx.createLinearGradient(0,0,0,256);
    gradient.addColorStop(0, '#0d0f2d');
    gradient.addColorStop(1, '#2a1e40');
    ctx.fillStyle = gradient;
    ctx.fillRect(0,0,1,256);
    return PIXI.Texture.from(canvas);
})());
sky.beginTextureFill({texture: skyTexture});
sky.drawRect(0, 0, window.innerWidth, window.innerHeight);
sky.endFill();
app.stage.addChild(sky);

// Stars
const stars = [];
for (let i = 0; i < 100; i++) {
    const star = new PIXI.Graphics();
    star.beginFill(0xffffff);
    star.drawCircle(0, 0, Math.random() * 1.5 + 0.5);
    star.endFill();
    star.x = Math.random() * window.innerWidth;
    star.y = Math.random() * window.innerHeight * 0.5;
    star.alpha = Math.random();
    app.stage.addChild(star);
    gsap.to(star, {alpha: Math.random(), duration: 1 + Math.random(), yoyo: true, repeat: -1});
    stars.push(star);
}

// Moon
const moon = new PIXI.Graphics();
moon.beginFill(0xffffdd);
moon.drawCircle(0, 0, 50);
moon.endFill();
moon.x = window.innerWidth - 100;
moon.y = 100;
moon.alpha = 0.85;
app.stage.addChild(moon);

// Mountains
const mountains = new PIXI.Graphics();
mountains.beginFill(0x1a1428);
mountains.moveTo(0, window.innerHeight * 0.5);
mountains.lineTo(window.innerWidth * 0.3, window.innerHeight * 0.3);
mountains.lineTo(window.innerWidth * 0.6, window.innerHeight * 0.5);
mountains.lineTo(window.innerWidth, window.innerHeight * 0.35);
mountains.lineTo(window.innerWidth, window.innerHeight);
mountains.lineTo(0, window.innerHeight);
mountains.closePath();
mountains.endFill();
app.stage.addChild(mountains);

// Cherry blossom tree (simplified silhouette)
const tree = new PIXI.Graphics();
tree.beginFill(0x4b2e2e);
tree.drawRect(-15, -200, 30, 200); // trunk
tree.endFill();
tree.beginFill(0xffb7c5, 0.8); // pink glow top
tree.drawCircle(0, -250, 100);
tree.endFill();
tree.x = window.innerWidth * 0.7;
tree.y = window.innerHeight * 0.7;
app.stage.addChild(tree);

// Falling petals
const petals = [];
for (let i = 0; i < 30; i++) {
    const petal = new PIXI.Graphics();
    petal.beginFill(0xffc0cb);
    petal.drawEllipse(0, 0, 5, 3);
    petal.endFill();
    petal.x = tree.x + (Math.random() * 200 - 100);
    petal.y = tree.y - 250 + Math.random() * 100;
    petal.vy = 0.5 + Math.random() * 0.5;
    petals.push(petal);
    app.stage.addChild(petal);
}

// Fireflies
const fireflies = [];
for (let i = 0; i < 15; i++) {
    const fly = new PIXI.Graphics();
    fly.beginFill(0xffff99);
    fly.drawCircle(0, 0, 2);
    fly.endFill();
    fly.x = Math.random() * window.innerWidth;
    fly.y = window.innerHeight * 0.5 + Math.random() * window.innerHeight * 0.5;
    app.stage.addChild(fly);
    gsap.to(fly, {alpha: 0, duration: 1 + Math.random(), yoyo: true, repeat: -1});
    fireflies.push(fly);
}

// Character (simple circle as placeholder cat)
const cat = new PIXI.Graphics();
cat.beginFill(0xffddaa);
cat.drawCircle(0, 0, 25);
cat.endFill();
cat.x = -50;
cat.y = window.innerHeight * 0.7;
app.stage.addChild(cat);

// Cake
const cake = new PIXI.Graphics();
cake.beginFill(0xffc0cb);
cake.drawRect(-20, -20, 40, 20); // cake base
cake.endFill();
cake.beginFill(0xffff99);
cake.drawCircle(0, -20, 5); // candle flame
cake.endFill();
cake.x = window.innerWidth / 2;
cake.y = -50;
app.stage.addChild(cake);

// Balloons group
const balloons = new PIXI.Container();
app.stage.addChild(balloons);

// Wishes
const wishes = [
    "Have a beautiful year!",
    "Youâ€™re amazing!",
    "Smile always!",
    "Stay blessed, Somaiya!"
];

// Final text
const finalText = new PIXI.Text("Happy Birthday, Somaiya! ðŸŽ‰", {
    fontFamily: "Arial",
    fontSize: 48,
    fill: 0xffc0cb,
    align: "center",
    dropShadow: true,
    dropShadowColor: "#000000",
    dropShadowBlur: 4
});
finalText.anchor.set(0.5);
finalText.x = window.innerWidth / 2;
finalText.y = window.innerHeight / 2;
finalText.alpha = 0;
app.stage.addChild(finalText);

// ----- ANIMATION FLOW -----

// Move cat to center
gsap.to(cat, {duration: 3, x: window.innerWidth / 2 - 100, ease: "power1.inOut"});

// Drop cake
gsap.to(cake, {duration: 2, delay: 2, y: window.innerHeight * 0.7 - 25, ease: "bounce.out"});

// Cake click event
cake.interactive = true;
cake.buttonMode = true;
cake.on("pointerdown", () => {
    gsap.to(cat, {
        duration: 2,
        x: cake.x - 50,
        ease: "power1.inOut",
        onComplete: () => {
            gsap.to(cake.children, {alpha: 0, duration: 0.5}); // blow candle
            spawnBalloons();
            gsap.to(finalText, {alpha: 1, duration: 2, delay: 2});
            gsap.to(finalText.scale, {x: 1.05, y: 1.05, duration: 2, yoyo: true, repeat: -1});
        }
    });
});

function spawnBalloons() {
    wishes.forEach((wish, i) => {
        const balloon = new PIXI.Graphics();
        balloon.beginFill(0xff0000 + Math.random() * 0xffffff);
        balloon.drawCircle(0, 0, 20);
        balloon.endFill();
        const text = new PIXI.Text(wish, {fontSize: 14, fill: 0xffffff, align: "center", wordWrap: true, wordWrapWidth: 100});
        text.anchor.set(0.5, -1.5);
        balloon.addChild(text);
        balloon.x = window.innerWidth / 2;
        balloon.y = window.innerHeight * 0.7;
        balloons.addChild(balloon);
        gsap.to(balloon, {y: -50, duration: 6 + Math.random() * 2, delay: i * 0.5, ease: "power1.in"});
    });
}

// Game loop for petals & fireflies
app.ticker.add(() => {
    petals.forEach(petal => {
        petal.y += petal.vy;
        petal.x += Math.sin(petal.y / 20) * 0.3;
        if (petal.y > window.innerHeight) {
            petal.y = tree.y - 250;
            petal.x = tree.x + (Math.random() * 200 - 100);
        }
    });
    fireflies.forEach(fly => {
        fly.x += Math.sin(Date.now() / 1000 + fly.y) * 0.2;
    });
});
</script>
</body>
</html>
